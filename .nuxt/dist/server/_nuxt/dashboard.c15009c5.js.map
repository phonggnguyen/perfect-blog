{"version":3,"file":"dashboard.c15009c5.js","sources":["../../../../composables/dashboard.ts"],"sourcesContent":["import type { Profiles } from \"~~/utils/types\"\nimport type { Ref } from \"vue\"\nimport { removeVietnameseTones } from \"~/utils/functions\";\n\nexport const useProfile = () => useState<Profiles>(\"profile\", () => null)\n\nexport const useProfileSave = (payload: Ref<Partial<Profiles>>) => {\n  const user = useSupabaseUser()\n  const client = useSupabaseClient()\n\n  const isSaving = ref(false)\n\n  const save = async () => {\n    // validate input here (if any)\n    isSaving.value = true\n\n    console.log(\"save profile settings\", payload.value)\n    console.log(\"save profile user\", user.value)\n    const isFacebook = user.value.app_metadata.provider === 'facebook'\n    console.log({ isFacebook })\n    if (isFacebook) {\n      payload.value.avatar_url = user.value.user_metadata.avatar_url\n      payload.value.username = removeVietnameseTones(user.value.user_metadata.name)\n          .replaceAll(\" \", \"\")\n          .toLowerCase()\n    }\n\n    const { data } = await client\n      .from<Profiles>(\"profiles\")\n      .upsert({ ...payload.value, id: user.value?.id })\n      .single()\n\n    console.log({ data })\n    isSaving.value = false\n  }\n\n  useMagicKeys({\n    passive: false,\n    onEventFired(e) {\n      if ((e.ctrlKey || e.metaKey) && e.key === \"s\" && e.type === \"keydown\") {\n        e.preventDefault()\n        save()\n      }\n    },\n  })\n\n  return {\n    save,\n    isSaving,\n  }\n}\n"],"names":[],"mappings":";;;;AAIO,MAAA,aAAA,MAAA,SAAA,WAAA,MAAA,IAAA;AAEA,MAAA,iBAAA,CAAA,YAAA;AACL,QAAA,OAAA;AACA,QAAA,SAAA;AAEA,QAAA,WAAA,IAAA,KAAA;AAEA,QAAA,OAAA,YAAA;;AAEE,aAAA,QAAA;AAEA,YAAA,IAAA,yBAAA,QAAA,KAAA;AACA,YAAA,IAAA,qBAAA,KAAA,KAAA;AACA,UAAA,aAAA,KAAA,MAAA,aAAA,aAAA;AACA,YAAA,IAAA,EAAA,WAAA,CAAA;AACA,QAAA,YAAA;AACE,cAAA,MAAA,aAAA,KAAA,MAAA,cAAA;AACA,cAAA,MAAA,WAAA,sBAAA,KAAA,MAAA,cAAA,IAAA,EAAA,WAAA,KAAA,EAAA,EAAA,YAAA;AAAA,IAEiB;AAGnB,UAAA,EAAA,KAAA,IAAA,MAAA,OAAA,KAAA,UAAA,EAAA,OAAA,EAAA,GAAA,QAAA,OAAA,KAAA,UAAA,UAAA,mBAAA,GAAA,CAAA,EAAA;AAKA,YAAA,IAAA,EAAA,KAAA,CAAA;AACA,aAAA,QAAA;AAAA,EAAiB;AAGnB,eAAA;AAAA,IAAa,SAAA;AAAA,IACF,aAAA,GAAA;AAEP,WAAA,EAAA,WAAA,EAAA,YAAA,EAAA,QAAA,OAAA,EAAA,SAAA,WAAA;AACE,UAAA,eAAA;AACA;MAAK;AAAA,IACP;AAAA,EACF,CAAA;AAGF,SAAA;AAAA,IAAO;AAAA,IACL;AAAA,EACA;AAEJ;"}